<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>qz-star</title>
<style>
  body {
    background-color: #202124;
    color: #fff;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 20px;
  }

  h1 {
    text-align: center;
    margin-bottom: 10px;
  }

  #topBar {
    display: flex;
    flex-direction: column;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.5);
    background-color: #2c2c2c;
    width: 100%;
  }

  #tabs {
    display: flex;
    align-items: center;
    overflow-x: auto;
    background-color: #2c2c2c;
    padding: 4px 8px;
    height: 44px;
  }

  .tab {
    display: flex;
    align-items: center;
    background-color: #3c4043;
    margin-right: 4px;
    padding: 4px 10px;
    border-top-left-radius: 6px;
    border-top-right-radius: 6px;
    cursor: grab;
    transition: background-color 0.2s, box-shadow 0.2s;
    white-space: nowrap;
    position: relative;
  }

  .tab.active {
    background-color: #1a73e8;
    box-shadow: inset 0 -2px 0 #fff;
  }

  .tab span {
    margin-right: 8px;
    font-size: 14px;
  }

  .close-btn {
    background: none;
    border: none;
    color: #fff;
    font-size: 14px;
    margin-left: 8px;
    cursor: pointer;
    padding: 0;
  }

  .close-btn:hover {
    color: #d22;
  }

  #addTabBtn {
    font-size: 20px;
    font-weight: bold;
    padding: 4px 10px;
    border: none;
    border-radius: 4px;
    background-color: #3c4043;
    color: #fff;
    cursor: pointer;
    margin-left: 4px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  #addTabBtn:hover {
    background-color: #5c6369;
  }

  #addressContainer {
    display: flex;
    padding: 8px;
  }

  #addressBar {
    flex: 1;
    padding: 8px 12px;
    font-size: 14px;
    border: none;
    border-radius: 4px;
    background-color: #3c4043;
    color: #fff;
  }

  #addressBar:focus {
    outline: none;
    background-color: #5a5a5a;
  }

  #content {
    margin-top: 8px;
    height: 600px;
    border-radius: 0 0 8px 8px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.5);
  }

  iframe {
    width: 100%;
    height: 100%;
    border: none;
  }
</style>
</head>
<body>

<div id="topBar">
  <div id="tabs"></div>
  <div id="addressContainer">
    <input type="text" id="addressBar" placeholder="Enter URL and press Enter" onkeydown="if(event.key==='Enter'){navigateToAddress();}">
  </div>
</div>

<div id="content"></div>

<script>
  let tabs = [];
  let activeTabId = null;

  function createTab() {
    const id = Date.now() + Math.random();
    const tab = { id, title: 'New Tab', url: 'about:blank' };
    tabs.push(tab);
    renderTabs();
    setActiveTab(id);
  }

  function closeTab(id) {
    tabs = tabs.filter(t => t.id !== id);
    if (activeTabId === id) {
      if (tabs.length > 0) {
        setActiveTab(tabs[tabs.length -1].id);
      } else {
        document.getElementById('content').innerHTML = '';
        activeTabId = null;
        renderTabs();
      }
    } else {
      renderTabs();
    }
  }

  function setActiveTab(id) {
    activeTabId = id;
    const tab = tabs.find(t => t.id === id);
    if (tab) {
      loadContent(tab);
      document.getElementById('addressBar').value = tab.url === 'about:blank' ? '' : tab.url;
    }
    highlightActiveTab();
  }

  function highlightActiveTab() {
    document.querySelectorAll('.tab').forEach(t => {
      if (parseFloat(t.dataset.id) === activeTabId) {
        t.classList.add('active');
      } else {
        t.classList.remove('active');
      }
    });
  }

  function renderTabs() {
    const container = document.getElementById('tabs');
    container.innerHTML = '';

    tabs.forEach(t => {
      const tabEl = document.createElement('div');
      tabEl.className = 'tab';
      tabEl.dataset.id = t.id;
      if (t.id === activeTabId) tabEl.classList.add('active');

      const span = document.createElement('span');
      span.textContent = t.title;
      tabEl.appendChild(span);

      const closeBtn = document.createElement('button');
      closeBtn.innerHTML = 'Ã—';
      closeBtn.className = 'close-btn';
      closeBtn.onclick = (e) => { e.stopPropagation(); closeTab(t.id); };
      tabEl.appendChild(closeBtn);

      tabEl.onclick = () => setActiveTab(t.id);
      container.appendChild(tabEl);
    });

    const plusBtn = document.createElement('button');
    plusBtn.id = 'addTabBtn';
    plusBtn.innerHTML = '+';
    plusBtn.title = 'New Tab';
    plusBtn.onclick = createTab;
    container.appendChild(plusBtn);
  }

  // Function to load content into the active iframe
  function loadContent(tab) {
      const container = document.getElementById('content');
      container.innerHTML = '';
      
      if (tab.url && tab.url !== 'about:blank') {
          const iframe = document.createElement('iframe');
          
          // --- START OF CDN IMPLEMENTATION CHANGE ---
          
          // 1. Define the base URL for your CDN-hosted proxy loader HTML.
          // **!!! REMINDER: Change this URL to your actual JSDelivr path !!!**
          const cdnBaseUrl = 'https://cdn.jsdelivr.net/gh/sussyboi01/star@latest/s/embed.html'; 
          
          // 2. Set the iframe source to the CDN URL, passing the target URL 
          //    as an encoded hash fragment.
          iframe.src = `${cdnBaseUrl}#${encodeURIComponent(tab.url)}`;
          
          // --- END OF CDN IMPLEMENTATION CHANGE ---
          
          container.appendChild(iframe);
          
          // Optional: Add a listener to update the tab title after the iframe content loads
          iframe.onload = () => {
              // Attempt to get the actual title from the iframe content (may be blocked by CORS/security)
              // For now, we rely on the URL-based title set in navigateToAddress()
              console.log(`Content loaded for: ${tab.url}`);
          };
      }
  }

  function navigateToAddress() {
    const input = document.getElementById('addressBar');
    let url = input.value.trim();
    if (!url) return;

    if (!url.startsWith('http://') && !url.startsWith('https://')) {
      if (url.includes('.')) {
        url = 'https://' + url;
      } else {
        url = 'https://search.brave.com/search?q=' + encodeURIComponent(url);
      }
    }

    if (activeTabId === null && tabs.length === 0) {
      createTab();
    }
    const tab = tabs.find(t => t.id === activeTabId);
    if (tab) {
      tab.url = url;
      tab.title = (() => { try { return new URL(url).hostname; } catch { return 'Search'; } })();
      loadContent(tab);
      renderTabs();
    }
  }

  createTab();
</script>
</body>
</html> 
